<!-- Fil: src/app/todo/todo.html -->
<div class="card animate-fade-in max-h-[85vh] overflow-y-auto">
  <h2 class="mb-4 text-2xl font-bold text-green-300">📝 Min Todo-liste</h2>

  <!-- Sorteringsmeny -->
  <div class="flex justify-end mb-4">
    <label class="mr-2 text-sm text-white">Sorter etter:</label>
    <select
      [(ngModel)]="sortBy"
      class="text-sm text-white input bg-slate-800"
      style="background-color: #1e293b;"
    >
      <option value="date">Dato</option>
      <option value="name">Navn</option>
      <option value="category">Kategori</option>
    </select>
  </div>

  <!-- Skjema -->
  <form (submit)="addTask()" class="grid grid-cols-1 gap-3 mb-4 sm:grid-cols-2 lg:grid-cols-5">
    <input [(ngModel)]="newTask" name="task" placeholder="Hva skal gjøres?" class="w-full col-span-1 sm:col-span-2 input" />

    <input [(ngModel)]="newStartDate" name="startDate" type="date" class="w-full input" />
    <input [(ngModel)]="newDueDate" name="dueDate" type="date" class="w-full input" />
    <input [(ngModel)]="newDueTime" name="dueTime" type="time" class="w-full input" />
    <input [(ngModel)]="newEndTime" name="endTime" type="time" class="w-full input" />

    <select
      [(ngModel)]="newCategory"
      name="category"
      class="w-full text-white input bg-slate-800"
      style="background-color: #1e293b;"
    >
      <option value="" disabled selected>Velg kategori</option>
      <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      <option value="custom">Egendefinert...</option>
    </select>

    <input
      *ngIf="newCategory === 'custom'"
      [(ngModel)]="customCategory"
      name="customCategory"
      placeholder="Egen kategori"
      class="w-full text-white input bg-slate-800"
      style="background-color: #1e293b;"
    />

    <select
      [(ngModel)]="newPriority"
      name="priority"
      class="w-full text-white input bg-slate-800"
      style="background-color: #1e293b;"
    >
      <option value="" disabled selected>Prioritet</option>
      <option *ngFor="let p of priorities" [value]="p">{{ p }}</option>
    </select>

    <div class="flex items-center justify-center w-full text-white input bg-slate-800" style="background-color: #1e293b;">
      <input [(ngModel)]="newColor" name="color" type="color" class="w-6 h-6 bg-transparent border-0 cursor-pointer" />
    </div>

    <select
      [(ngModel)]="newRepeat"
      name="repeat"
      class="w-full text-white input bg-slate-800"
      style="background-color: #1e293b;"
    >
      <option value="" disabled selected>Gjentakelse</option>
      <option *ngFor="let r of repeats" [value]="r">{{ r }}</option>
    </select>

    <input [(ngModel)]="newLink" name="link" placeholder="Lenke (valgfritt)" class="w-full input" />
    <input [(ngModel)]="newProject" name="project" placeholder="Prosjekt" class="w-full input" />

    <input [(ngModel)]="newNote" name="note" placeholder="Notat / beskrivelse" class="w-full col-span-full input" />

    <button type="submit" class="w-full mt-2 btn btn-primary col-span-full">➕ Legg til</button>
  </form>

  <!-- Fullfør alle -->
  <div *ngIf="anyDone" class="mb-4 text-right">
    <button (click)="markAllDone()" class="text-xs text-green-400 hover:underline">
      ✅ Fullfør alle oppgaver
    </button>
  </div>

  <!-- Oppgavelister -->
  <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
    <div>
      <h3 class="mb-2 text-lg font-semibold text-green-300 uppercase">Aktive</h3>
      <ul class="space-y-2">
        <li
          *ngFor="let task of activeTasks; trackBy: trackById"
          class="flex flex-col p-3 rounded-lg"
          [ngStyle]="{ 'borderLeft': '4px solid ' + (task.color || '#4ade80') }"
        >
          <div class="flex items-center justify-between">
            <label class="flex items-center gap-3">
              <input type="checkbox" [checked]="task.done" (change)="toggle(task)" class="accent-green-300" />
              <span class="text-white">{{ task.text }}</span>
            </label>
            <button (click)="remove(task)" class="btn btn-danger">❌</button>
          </div>
          <p *ngIf="task.note" class="mt-1 text-sm ml-7 text-white/50">📝 {{ task.note }}</p>
          <div class="flex items-center mt-1 space-x-4 text-xs ml-7 text-white/70">
            <span *ngIf="task.startDate">🔓 {{ task.startDate }}</span>
            <span *ngIf="task.dueDate">📅 {{ task.dueDate }}</span>
            <span *ngIf="task.dueTime">⏰ {{ task.dueTime }}</span>
            <span *ngIf="task.endTime">⏱ {{ task.endTime }}</span>
            <span *ngIf="task.category">🗂️ {{ task.category }}</span>
            <span *ngIf="task.priority">🔥 {{ task.priority }}</span>
            <span *ngIf="task.repeat">🔁 {{ task.repeat }}</span>
            <span *ngIf="task.project">📂 {{ task.project }}</span>
            <a *ngIf="task.link" [href]="task.link" target="_blank" class="text-blue-400 underline">🔗 Vedlegg</a>
          </div>
        </li>
      </ul>
    </div>

    <div>
      <h3 class="mb-2 text-lg font-semibold text-green-300 uppercase">Ferdige</h3>
      <ul class="space-y-2">
        <li
          *ngFor="let task of completedTasks; trackBy: trackById"
          class="flex flex-col p-3 rounded-lg opacity-70"
          [ngStyle]="{ 'borderLeft': '4px solid ' + (task.color || '#4ade80') }"
        >
          <div class="flex items-center justify-between">
            <label class="flex items-center gap-3">
              <input type="checkbox" [checked]="task.done" (change)="toggle(task)" class="accent-green-300" />
              <span class="text-white line-through">{{ task.text }}</span>
            </label>
            <button (click)="remove(task)" class="btn btn-danger">❌</button>
          </div>
          <p *ngIf="task.note" class="mt-1 text-sm ml-7 text-white/50">📝 {{ task.note }}</p>
          <div class="flex items-center mt-1 space-x-4 text-xs ml-7 text-white/70">
            <span *ngIf="task.startDate">🔓 {{ task.startDate }}</span>
            <span *ngIf="task.dueDate">📅 {{ task.dueDate }}</span>
            <span *ngIf="task.dueTime">⏰ {{ task.dueTime }}</span>
            <span *ngIf="task.endTime">⏱ {{ task.endTime }}</span>
            <span *ngIf="task.category">🗂️ {{ task.category }}</span>
            <span *ngIf="task.priority">🔥 {{ task.priority }}</span>
            <span *ngIf="task.repeat">🔁 {{ task.repeat }}</span>
            <span *ngIf="task.project">📂 {{ task.project }}</span>
            <a *ngIf="task.link" [href]="task.link" target="_blank" class="text-blue-400 underline">🔗 Vedlegg</a>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>

<!--
  SAMMENDRAG (hva denne templaten gjør)
  ----------------------------------------------------
  - Viser et skjema for å registrere ny oppgave:
      • newTask (tekst), newDueDate (dato), newDueTime (tid), newCategory (valg), customCategory (tekst ved 'custom').
      • Bruker [(ngModel)] for toveis-binding. name-attributt er påkrevd for ngModel i form.
      • (submit)="addTask()" kaller komponentmetoden som oppretter ny Task.
        Tips: vurder (ngSubmit) på <form> for mer "Angular-riktig" håndtering.
  - Viser to lister:
      • Aktive (activeTasks) og Ferdige (completedTasks), hver rendret med *ngFor og trackById for ytelse.
      • toggle(task) flipper done; remove(task) sletter.
      • Meta-informasjon (dueDate, dueTime, category) vises kun når den finnes med *ngIf.
  - Tailwind/utility-klasser brukes for layout/typografi/farger; egne helper-klasser (card, btn, tag) kan være definert i din CSS.
-->
