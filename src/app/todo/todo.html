<!-- Fil: src/app/todo/todo.html -->
<div class="max-w-4xl mx-auto card card-fixed animate-fade-in">
  <!-- Topp: tittel + spr√•kvelger -->
  <div class="flex flex-col justify-between gap-4 mb-6 sm:flex-row sm:items-center">
    <h2 class="text-2xl font-bold text-green-300">üìù {{ 'TODO.TITLE' | translate }}</h2>

    <!-- Spr√•kvelger -->
    <select
      [value]="lang"
      (change)="changeLang($any($event.target).value)"
      class="px-2 py-1 text-white rounded bg-slate-800"
    >
      <option *ngFor="let lang of supportedLanguages" [value]="lang.code">
        üåç {{ 'LANG.' + lang.code | translate }}
      </option>
    </select>
  </div>

  <div class="flex justify-end gap-3 mb-4">
    <label class="text-white">{{ 'TODO.SORT_BY' | translate }}</label>
    <select [(ngModel)]="sortBy" class="px-2 py-1 text-white rounded bg-slate-800">
      <option value="date">{{ 'TODO.SORT_DATE' | translate }}</option>
      <option value="name">{{ 'TODO.SORT_NAME' | translate }}</option>
      <option value="category">{{ 'TODO.SORT_CATEGORY' | translate }}</option>
    </select>
    <button (click)="toggleForm()" class="text-xs text-green-300 hover:underline">
      {{ showForm ? ('TODO.HIDE_FORM' | translate) : ('TODO.SHOW_FORM' | translate) }}
    </button>
  </div>

  <form *ngIf="showForm" (ngSubmit)="addTask()" class="mb-6 space-y-4">
    <div>
      <label class="block text-xs text-white/60">{{ 'TODO.LABEL_TASK' | translate }}</label>
      <input
        [(ngModel)]="newTask"
        name="task"
        class="w-full input"
        placeholder="{{ 'TODO.PLACEHOLDER_TASK' | translate }}"
      />
    </div>

    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
      <div>
        <label class="block text-xs text-white/60">{{ 'TODO.LABEL_DUEDATE' | translate }}</label>
        <input [(ngModel)]="newDueDate" name="dueDate" type="date" class="w-full input" />
      </div>
      <div>
        <label class="block text-xs text-white/60">{{ 'TODO.LABEL_DUETIME' | translate }}</label>
        <input [(ngModel)]="newDueTime" name="dueTime" type="time" class="w-full input" />
      </div>
      <div>
        <label class="block text-xs text-white/60">{{ 'TODO.LABEL_CATEGORY' | translate }}</label>
        <select [(ngModel)]="newCategory" name="category" class="w-full input">
          <option value="" disabled>{{ 'TODO.OPT_CATEGORY' | translate }}</option>
          <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
          <option value="custom">{{ 'TODO.OPT_CATEGORY_CUSTOM' | translate }}</option>
        </select>
      </div>
      <div>
        <label class="block text-xs text-white/60">{{ 'TODO.LABEL_PRIORITY' | translate }}</label>
        <select [(ngModel)]="newPriority" name="priority" class="w-full input">
          <option value="" disabled>{{ 'TODO.OPT_PRIORITY' | translate }}</option>
          <option *ngFor="let p of priorities" [value]="p">{{ p }}</option>
        </select>
      </div>
    </div>

    <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
      <div>
        <label class="block text-xs text-white/60">{{ 'TODO.LABEL_LINK' | translate }}</label>
        <input
          [(ngModel)]="newLink"
          name="link"
          class="w-full input"
          placeholder="{{ 'TODO.PLACEHOLDER_LINK' | translate }}"
        />
      </div>
      <div>
        <label class="block text-xs text-white/60">{{ 'TODO.LABEL_NOTE' | translate }}</label>
        <textarea
          [(ngModel)]="newNote"
          name="note"
          rows="2"
          class="w-full input"
          placeholder="{{ 'TODO.PLACEHOLDER_NOTE' | translate }}"
        ></textarea>
      </div>
    </div>

    <button type="submit" class="w-full btn btn-primary">
      {{ 'TODO.ADD_BUTTON' | translate }}
    </button>
  </form>

  <div class="grid grid-cols-1 gap-8 md:grid-cols-2">
    <div>
      <h3 class="mb-2 text-lg font-semibold text-green-300">
        {{ 'TODO.ACTIVE_TITLE' | translate }}
      </h3>
      <ul class="space-y-3">
        <li
          *ngFor="let t of activeTasks | slice : 0 : (showAllActive ? activeTasks.length : 3)"
          class="p-3 border-l-4 rounded"
          [ngStyle]="{ borderLeftColor: t.color || '#4ade80' }"
        >
          <div class="flex items-center justify-between">
            <span>{{ t.text }}</span>
            <div class="space-x-2">
              <button (click)="toggle(t)" class="btn btn-sm">
                {{ 'TODO.MARK_DONE' | translate }}
              </button>
              <button (click)="remove(t)" class="btn btn-danger">
                {{ 'TODO.REMOVE' | translate }}
              </button>
            </div>
          </div>
        </li>
      </ul>
      <button
        *ngIf="activeTasks.length > 3"
        (click)="toggleShowAll('active')"
        class="mt-2 text-xs text-green-300 hover:underline"
      >
        {{ showAllActive ? ('TODO.SHOW_LESS' | translate) : ('TODO.SHOW_MORE' | translate) }}
      </button>
    </div>

    <div>
      <h3 class="mb-2 text-lg font-semibold text-green-300">
        {{ 'TODO.COMPLETED_TITLE' | translate }}
      </h3>
      <ul class="space-y-3">
        <li
          *ngFor="
            let t of completedTasks | slice : 0 : (showAllCompleted ? completedTasks.length : 3)
          "
          class="p-3 border-l-4 rounded opacity-70"
          [ngStyle]="{ borderLeftColor: t.color || '#4ade80' }"
        >
          <div class="flex items-center justify-between">
            <span class="line-through">{{ t.text }}</span>
            <button (click)="toggle(t)" class="btn btn-sm">
              {{ 'TODO.MARK_ACTIVE' | translate }}
            </button>
          </div>
        </li>
      </ul>
      <button
        *ngIf="completedTasks.length > 3"
        (click)="toggleShowAll('completed')"
        class="mt-2 text-xs text-green-300 hover:underline"
      >
        {{ showAllCompleted ? ('TODO.SHOW_LESS' | translate) : ('TODO.SHOW_MORE' | translate) }}
      </button>
    </div>
  </div>
</div>

<!--
  SAMMENDRAG (hva denne templaten gj√∏r)
  ----------------------------------------------------
  - Fjerner scroll fra kortet og lar hele siden scrolle naturlig.
  - Rydder opp skjema:
      ‚Ä¢ Labels over feltene, konsekvent grid (1 / 2 / 4 kolonner).
      ‚Ä¢ Egendefinert kategori vises kun n√•r den trengs.
      ‚Ä¢ Notat som <textarea> for bedre skriving.
      ‚Ä¢ √ân, stor ¬´Legg til¬ª-knapp nederst.
  - Bruker .tag-chips i oppgavekort for meta (dato/tid/kategori osv.).
  - Beholder farger og stil (.card/.input/.btn) fra styles.css.
-->
